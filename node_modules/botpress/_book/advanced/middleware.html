
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Middleware Chains Â· Botpress Official Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-noembed/style.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="database_helpers.html" />
    
    
    <link rel="prev" href="../deploy/aws.html" />
    

    </head>
    <body>
        
    
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../starting/setup.html">
            
                <a href="../starting/setup.html">
            
                    
                    Installation and Bootstrap
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Foundamentals</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../foundamentals/structure.html">
            
                <a href="../foundamentals/structure.html">
            
                    
                    Project Structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../foundamentals/events.html">
            
                <a href="../foundamentals/events.html">
            
                    
                    Events
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../foundamentals/events.html">
            
                <a href="../foundamentals/events.html#receive">
            
                    
                    Receiving Messages
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../foundamentals/events.html">
            
                <a href="../foundamentals/events.html#send">
            
                    
                    Sending Messages
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../foundamentals/conversations.html">
            
                <a href="../foundamentals/conversations.html">
            
                    
                    Conversations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../foundamentals/flow.html">
            
                <a href="../foundamentals/flow.html">
            
                    
                    Flow Management (Convo)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../foundamentals/umm.html">
            
                <a href="../foundamentals/umm.html">
            
                    
                    Content Management (UMM)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../foundamentals/database.html">
            
                <a href="../foundamentals/database.html">
            
                    
                    Data Storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../foundamentals/database.html">
            
                <a href="../foundamentals/database.html#kvs">
            
                    
                    Key-Value-Store
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../foundamentals/botfile.html">
            
                <a href="../foundamentals/botfile.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Deploying your bot</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../deploy/heroku.html">
            
                <a href="../deploy/heroku.html">
            
                    
                    Heroku
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../deploy/aws.html">
            
                <a href="../deploy/aws.html">
            
                    
                    AWS
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Advanced concepts</li>
        
        
    
        <li class="chapter active" data-level="4.1" data-path="middleware.html">
            
                <a href="middleware.html">
            
                    
                    Middleware Chains
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="database_helpers.html">
            
                <a href="database_helpers.html">
            
                    
                    Database Helpers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="debug.html">
            
                <a href="debug.html">
            
                    
                    Debugging your bot
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    

    
        
        <li class="header">Reference</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html">
            
                    
                    Command Line Interface (CLI)
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#init">
            
                    
                    init
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#list">
            
                    
                    list
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#install">
            
                    
                    install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#uninstall">
            
                    
                    uninstall
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#create">
            
                    
                    create
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../reference/cli.html">
            
                <a href="../reference/cli.html#version">
            
                    
                    version
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    

    
        
        <li class="header">Module Development</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../modules/how.html">
            
                <a href="../modules/how.html">
            
                    
                    How to create a module
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="../modules/events.html">
            
                <a href="../modules/events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="../modules/api.html">
            
                <a href="../modules/api.html">
            
                    
                    Exposing an API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.3" data-path="../modules/config.html">
            
                <a href="../modules/config.html">
            
                    
                    Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.4" data-path="../modules/icon.html">
            
                <a href="../modules/icon.html">
            
                    
                    Module Icon
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Middleware Chains</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="understanding-the-middlewares"><a name="understanding-the-middlewares" class="plugin-anchor" href="#understanding-the-middlewares"><i class="fa fa-link" aria-hidden="true"></i></a>Understanding the Middlewares</h2>
<p>Middleware is a critical component of botpress. Simply put, it is a collection of functions that process messages. Think of it this way: everything that enters or leaves your bot is coming in to (or out of) the middleware.</p>
<p>If you have used <a href="http://expressjs.com/" target="_blank">Express</a> before, botpress middleware is very similar to express&apos;s middleware.</p>
<p>Botpress has two middleware chains: <a href="understading-the-middlewares.md#sendincomingmiddlewareevent---void">incoming</a> and <a href="understading-the-middlewares.md#sendoutgoingmiddlewareevent---void">outgoing</a></p>
<p><strong>To receive messages</strong>: An installed module must send messages into the incoming middleware chain</p>
<p><strong>To send messages</strong>: You (or a module) must send messages into the outgoing middleware chain and have a module able to send it to the right platform</p>
<h3 id="example"><a name="example" class="plugin-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h3>
<p><strong>Incoming</strong>: <a href="https://github.com/botpress/botpress-messenger" target="_blank">botpress-messenger</a> connects to Facebook and receives messages from its built-in Webhook. It then sends messages into the incoming middleware, which your bot can process.</p>
<p><strong>Outgoing</strong>: <a href="https://github.com/botpress/botpress-messenger" target="_blank">botpress-messenger</a> listens (through a middleware function) for messages it can process on the outgoing middleware and sends them to Facebook through the Messenger Send API.</p>
<h2 id="middleware-chain"><a name="middleware-chain" class="plugin-anchor" href="#middleware-chain"><i class="fa fa-link" aria-hidden="true"></i></a>Middleware Chain</h2>
<p>A middleware chain is simply a collection of middleware functions that are called in a predertermined order. Each middleware function in the chain has the freedom to:</p>
<ul>
<li>execute arbitrary code</li>
<li>mutate the event</li>
<li>call the next middleware</li>
<li>interrupt the chain by never calling the next middleware (what we call swallowing the event)</li>
<li>interrupt the chain by throwing an error</li>
</ul>
<p><img alt="Middleware Chain" width="600" src="https://raw.githubusercontent.com/botpress/botpress/next/assets/middleware-chain.png"></p>
<h2 id="a-simple-middleware-function"><a name="a-simple-middleware-function" class="plugin-anchor" href="#a-simple-middleware-function"><i class="fa fa-link" aria-hidden="true"></i></a>A simple middleware function</h2>
<p>A middleware function is simply a function that takes an event as the first parameter and a <code>next</code> function as the second parameter.</p>
<p>Here&apos;s an example of the 5 possible cases:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> middleware = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event, next</span>) </span>{
    <span class="hljs-comment">// chain interruption (error)</span>
    <span class="hljs-keyword">if</span> (internetDisconnected())
        <span class="hljs-keyword">return</span> next(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&apos;Not connected&apos;</span>))

    <span class="hljs-keyword">if</span> (isUserBanned(event.user.id))
        <span class="hljs-keyword">return</span> <span class="hljs-comment">// swallow the event</span>

    <span class="hljs-comment">// arbitraty code execution</span>
    <span class="hljs-keyword">var</span> translation = Translator.translate(event.text)

    <span class="hljs-comment">// event mutation</span>
    event.text = translation

    <span class="hljs-comment">// call next middleware function</span>
    next()
}
</code></pre>
<p>The return value of the middleware function isn&apos;t used by Botpress.</p>
<h2 id="registering-middlewares"><a name="registering-middlewares" class="plugin-anchor" href="#registering-middlewares"><i class="fa fa-link" aria-hidden="true"></i></a>Registering middlewares</h2>
<p>You need to register a middleware function for botpress to know about it and use it. You may do so with the <a href="understading-the-middlewares.md#registermiddlewaredefinition-void"><code>bp.middlewares.register</code></a> method:</p>
<pre><code class="lang-js"><span class="hljs-comment">// ** code taken from botpress-messenger **</span>
bp.middlewares.register({
    name: <span class="hljs-string">&apos;messenger.sendMessages&apos;</span>, <span class="hljs-comment">// friendly name</span>
    type: <span class="hljs-string">&apos;outgoing&apos;</span>, <span class="hljs-comment">// either incoming or outgoing</span>
    order: <span class="hljs-number">100</span>, <span class="hljs-comment">// arbitrary number</span>
    handler: outgoingMiddleware, <span class="hljs-comment">// the middleware function</span>
    <span class="hljs-built_in">module</span>: <span class="hljs-string">&apos;botpress-messenger&apos;</span>, <span class="hljs-comment">// the name of the module, if any</span>
    description: <span class="hljs-string">&apos;Sends out messages that targets platform = &apos;</span>
    + <span class="hljs-string">&apos;messenger. This middleware should be placed at the end as it swallows events once sent.&apos;</span>
})
</code></pre>
<p>Once all middleware functions have been registered (usually modules should register middleware functions immediately in their initialization), <strong>you must load them</strong> using <a href="understading-the-middlewares.md#load-void"><code>bp.middlewares.load()</code></a>, which will create the incoming and outgoing chains automatically.</p>
<p>Once middleware functions are loaded, you&apos;ll see them displayed in your bot&apos;s interface:</p>
<p><img src="https://raw.githubusercontent.com/botpress/botpress/master/assets/screenshot-middlewares.png" alt=""></p>
<h2 id="ordering-middleware-functions"><a name="ordering-middleware-functions" class="plugin-anchor" href="#ordering-middleware-functions"><i class="fa fa-link" aria-hidden="true"></i></a>Ordering middleware functions</h2>
<p>By default, middleware functions are ordered by <strong>ascending order</strong> according to their <code>order</code> property set on registration. The order can then be manually overwritten:</p>
<p><img src="https://raw.githubusercontent.com/botpress/botpress/master/assets/screenshot-middlewares-order.png" alt=""></p>
<p>You can also re-order them programmatically using middleware function customizations.</p>
<h2 id="full-messages-lifecycle-example"><a name="full-messages-lifecycle-example" class="plugin-anchor" href="#full-messages-lifecycle-example"><i class="fa fa-link" aria-hidden="true"></i></a>Full Messages Lifecycle Example</h2>
<p>Imagine you have a travel bot that is available on Facebook Messenger and Slack and that can handle many languages.</p>
<p>Your bot&apos;s installed modules would probably look a bit like:</p>
<ul>
<li><a href="https://github.com/botpress/botpress-messenger" target="_blank">botpress-messenger</a> for I/O with Facebook Messenger</li>
<li><a href="https://github.com/botpress/botpress-slack" target="_blank">botpress-slack</a> for I/O with Slack</li>
<li><a href="https://github.com/botpress/botpress-analytics" target="_blank">botpress-analytics</a> to have an overview of how people use your bot</li>
<li>botpress-translate <em>(fictive)</em> to translate incoming and outgoing messages</li>
<li>~/my-bot/private_modules/botpress-travel <em>(fictive)</em> your bot&apos;s travel logic goes here</li>
</ul>
<p>Now lets look at how a complete interaction might be handled by your bot.</p>
<ol>
<li>A user types a message in French to your bot in Facebook Messenger</li>
<li>Facebook pushes the message to your bot via the built-in botpress-messenger&apos;s Webhook</li>
<li>botpress-messenger retrieves the user information and stores it in the built-in database</li>
<li>botpress-messenger parses the message and <strong>calls the first incoming middleware function</strong> <em>(botpress-analytics)</em></li>
<li>botpress-analytics tracks the message then <strong>calls the next middleware function</strong> in the chain <em>(botpress-translate)</em></li>
<li>botpress-translate translates the message from French to English (by mutating it) then calls the next middleware function in the chain <em>(botpress-travel)</em></li>
<li>botpress-travel processes the message and responds by calling the <code>bp.messenger.sendText</code> method</li>
<li>botpress-messenger takes the response and <strong>calls the outgoing middlewares chain</strong></li>
<li>botpress-translate translates the message from English to French (by mutating it) then calls the next middleware function in the outgoing chain <em>(botpress-analytics)</em></li>
<li>botpress-analytics tracks the message then calls the next middleware function <em>(botpress-messenger)</em></li>
<li>botpress-slack will ignore the message because it doesn&apos;t know how to process messages with <code>type: facebook</code></li>
<li>botpress-messenger sends the message to Facebook Messenger through the Send API</li>
</ol>
<p>All of this happens behind the scenes and is handled by the modules middleware. As a bot developer, all you have to worry about is writing the bot&apos;s logic.</p>
<h2 id="api-reference"><a name="api-reference" class="plugin-anchor" href="#api-reference"><i class="fa fa-link" aria-hidden="true"></i></a>API reference</h2>
<h4 id="load-void"><a name="load-void" class="plugin-anchor" href="#load-void"><i class="fa fa-link" aria-hidden="true"></i></a><code>load()&gt; void</code></h4>
<p>Loads (or reloads) all the middleware in the correct order (ordered by their <code>order</code> property. Customizations (custom order and enabled/disabled) set in the UI are also taken into account.</p>
<p>This method <strong>must</strong> be called in your bot initialization in order for it to work properly.</p>
<h5 id="example"><a name="example" class="plugin-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h5>
<pre><code class="lang-js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">bp</span>) </span>{
  bp.middlewares.load()
}
</code></pre>
<h4 id="registermiddlewaredefinition-void"><a name="registermiddlewaredefinition-void" class="plugin-anchor" href="#registermiddlewaredefinition-void"><i class="fa fa-link" aria-hidden="true"></i></a><code>register(MiddlewareDefinition)&gt; void</code></h4>
<h5 id="middlewaredefinition"><a name="middlewaredefinition" class="plugin-anchor" href="#middlewaredefinition"><i class="fa fa-link" aria-hidden="true"></i></a>MiddlewareDefinition</h5>
<pre><code class="lang-js">{
  name: string, <span class="hljs-comment">// *required*</span>
  type: string(ingoing|outgoing), <span class="hljs-comment">// *required*</span>
  handler: <span class="hljs-function"><span class="hljs-keyword">function</span>, // *<span class="hljs-title">required</span>*
  <span class="hljs-title">order</span>: <span class="hljs-title">int</span>,
  <span class="hljs-title">module</span>: <span class="hljs-title">string</span>,
  <span class="hljs-title">description</span>: <span class="hljs-title">string</span>
}
</span></code></pre>
<h5 id="example"><a name="example" class="plugin-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h5>
<pre><code class="lang-js"><span class="hljs-comment">// Taken from botpress-messenger/src/index.js</span>

bp.middlewares.register({
  name: <span class="hljs-string">&apos;messenger.sendMessages&apos;</span>,
  type: <span class="hljs-string">&apos;outgoing&apos;</span>,
  order: <span class="hljs-number">100</span>,
  handler: outgoingMiddleware,
  <span class="hljs-built_in">module</span>: <span class="hljs-string">&apos;botpress-messenger&apos;</span>,
  description: <span class="hljs-string">&apos;Sends out messages that targets platform = messenger.&apos;</span> +
  <span class="hljs-string">&apos; This middleware should be placed at the end as it swallows events once sent.&apos;</span>
})
</code></pre>
<h4 id="sendincomingmiddlewareevent-void"><a name="sendincomingmiddlewareevent-void" class="plugin-anchor" href="#sendincomingmiddlewareevent-void"><i class="fa fa-link" aria-hidden="true"></i></a><code>sendIncoming(MiddlewareEvent)&gt; void</code></h4>
<h5 id="middlewareevent"><a name="middlewareevent" class="plugin-anchor" href="#middlewareevent"><i class="fa fa-link" aria-hidden="true"></i></a>MiddlewareEvent</h5>
<pre><code class="lang-js">{
  type: string, <span class="hljs-comment">// *required*, e.g. &apos;message&apos;, &apos;postback&apos;</span>
  platform: string, <span class="hljs-comment">// *required*, e.g. &apos;facebook&apos;, &apos;slack&apos;</span>
  text: string, <span class="hljs-comment">// *required*, the textual representation of the event value</span>
  raw: any <span class="hljs-comment">// *required*, the raw event, as received from the platform</span>
}
</code></pre>
<h5 id="example"><a name="example" class="plugin-anchor" href="#example"><i class="fa fa-link" aria-hidden="true"></i></a>Example</h5>
<pre><code class="lang-js">bp.middlewares.sendIncoming({
  type: <span class="hljs-string">&apos;postback&apos;</span>,
  platform: <span class="hljs-string">&apos;facebook&apos;</span>,
  text: <span class="hljs-string">&apos;GET_STARTED&apos;</span>,
  raw: fbEvent <span class="hljs-comment">// complex object</span>
})
</code></pre>
<h4 id="sendoutgoingmiddlewareevent-void"><a name="sendoutgoingmiddlewareevent-void" class="plugin-anchor" href="#sendoutgoingmiddlewareevent-void"><i class="fa fa-link" aria-hidden="true"></i></a><code>sendOutgoing(MiddlewareEvent)&gt; void</code></h4>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../deploy/aws.html" class="navigation navigation-prev " aria-label="Previous page: AWS">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="database_helpers.html" class="navigation navigation-next " aria-label="Next page: Database Helpers">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Middleware Chains","level":"4.1","depth":1,"next":{"title":"Database Helpers","level":"4.2","depth":1,"path":"advanced/database_helpers.md","ref":"./advanced/database_helpers.md","articles":[]},"previous":{"title":"AWS","level":"3.2","depth":1,"path":"deploy/aws.md","ref":"./deploy/aws.md","articles":[]},"dir":"ltr"},"config":{"plugins":["noembed","sitemap","expandable-chapters","hints","anchors","robotstxt"],"root":"./docs","styles":{"website":"./_layouts/website/style.css"},"pluginsConfig":{"robotstxt":{},"search":{},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"hostname":"https://docs.botpress.io/"},"noembed":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"version":"1.0.5","assets":"https://raw.githubusercontent.com/botpress/botpress/next/assets"},"title":"Botpress Official Documentation","gitbook":">= 3.0.0"},"file":{"path":"advanced/middleware.md","mtime":"2017-06-02T20:53:29.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-06-09T15:03:30.456Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>


    <script>
        window.onload = function() {
          require(['gitbook', 'jQuery'], function(gitbook, $) {
            function removeGitbook() {
              var link = $('.gitbook-link').parent();
              link.prev().remove();
              link.remove();
            }
            removeGitbook();
            gitbook.events.bind('page.change', removeGitbook);

            var link = document.createElement('link')
            link.setAttribute('rel', 'stylesheet')
            link.setAttribute('type', 'text/css')
            link.setAttribute('href', 'https://cdn.rawgit.com/botpress/botpress/next/docs/_layouts/website/style.css')
            document.getElementsByTagName('head')[0].appendChild(link)
          })
        };
    </script>


        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-noembed/scripts.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

